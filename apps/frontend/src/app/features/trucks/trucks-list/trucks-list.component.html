<div class="p-6 space-y-6">
  <!-- Header -->
  <div class="flex justify-between items-center">
    <div>
      <h1 class="text-2xl font-bold text-base-content">Trucks</h1>
      <p class="text-base-content/60">Manage and view all fleet trucks</p>
    </div>
    <div class="flex items-center space-x-2">
      <button class="btn btn-primary" (click)="openCreateForm()">
        <span class="mr-2" aria-hidden="true">â•</span> Add Truck
      </button>
    </div>
  </div>

  <!-- Loading State -->
  @if (loading()) {
  <div class="flex justify-center p-12" aria-busy="true" aria-label="Loading trucks">
    <span class="loading loading-spinner loading-lg text-primary"></span>
  </div>
  } @else {
  <!-- Empty State -->
  @if (trucks().length === 0) {
    <div
      class="empty-state flex flex-col items-center justify-center p-12 bg-base-200 rounded-xl border-2 border-dashed border-base-300">
      <div class="text-6xl mb-4" aria-hidden="true">ğŸšš</div>
      <h3 class="text-xl font-semibold">No trucks found</h3>
      <p class="text-base-content/60 mb-6 text-center max-w-sm">
        It looks like you haven't added any trucks yet. Start by creating your first truck record.
      </p>
      <button class="btn btn-primary" (click)="openCreateForm()">
        Add Your First Truck
      </button>
    </div>
  } @else if (trucks().length > 0) {
  <!-- Table -->
  <div class="overflow-x-auto bg-base-100 rounded-xl shadow-sm border border-base-200">
    <table class="table table-zebra table-sm" aria-label="Trucks Registry">
      <thead>
        <tr>
          <th>Name</th>
          <th>Registration</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        @for (truck of trucks(); track truck.id) {
        <tr
          class="hover cursor-pointer"
          (click)="openEditForm(truck)"
          [class.opacity-50]="deletingId() === truck.id">
          <td>
            <div class="font-medium">{{ truck.name }}</div>
            @if (truck.notes) {
            <div class="text-xs text-base-content/60">{{ truck.notes }}</div>
            }
          </td>
          <td>
            <span class="font-mono text-sm">{{ truck.registrationNumber }}</span>
          </td>
          <td>
            <span class="badge {{ getStatusClass(truck.status) }}">{{ truck.status }}</span>
          </td>
          <td (click)="$event.stopPropagation()">
            @if (deletingId() === truck.id) {
            <!-- Inline Confirmation -->
            <div class="flex items-center space-x-2">
              <span class="text-sm text-warning">Archive this truck?</span>
              <button
                class="btn btn-xs btn-error"
                (click)="confirmDelete(truck)"
                aria-label="Confirm archive">
                âœ“
              </button>
              <button
                class="btn btn-xs btn-ghost"
                (click)="cancelDelete()"
                aria-label="Cancel archive">
                âœ—
              </button>
            </div>
            } @else {
            <!-- Regular Actions -->
            <button
              class="btn btn-ghost btn-xs"
              (click)="startDelete(truck)"
              aria-label="Archive truck"
              title="Archive truck">
              ğŸ—‘ï¸
            </button>
            }
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
  }

  <!-- Inline Form Drawer (Create/Edit) -->
  @if (showForm() && deletingId() === null) {
  <div class="fixed inset-0 z-50 flex justify-end">
    <!-- Backdrop -->
    <div
      class="fixed inset-0 bg-base-300/50 backdrop-blur-sm transition-opacity"
      (click)="closeForm()"></div>

    <!-- Drawer Panel -->
    <div class="relative w-full max-w-md bg-base-100 shadow-xl h-full overflow-y-auto">
      <app-truck-form
        [truckId]="editingId()"
        (submit)="onFormSubmit($event)"
        (cancel)="closeForm()"
      />
    </div>
  </div>
  }
  }
}
